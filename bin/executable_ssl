#!/usr/bin/env bash

set -e
set -o pipefail

TESTSSL="${TESTSSL:-docker run --network=host --rm -it drwetter/testssl.sh:3.0}"

case "$1" in
    show)
        echo | openssl s_client -showcerts -servername "$2" -connect "$2:443" 2>/dev/null | openssl x509 -inform pem -noout -text
        ;;
    date)
        echo | openssl s_client -servername "$2" -connect "$2:443" 2>/dev/null | openssl x509 -noout -dates
        ;;
    check)
        $TESTSSL "${@:2}"
        ;;
    search)
        $BROWSER https://crt.sh/
        ;;
esac
