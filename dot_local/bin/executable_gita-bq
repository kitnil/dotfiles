#!/usr/bin/env bash

set -e

config()
{
    while IFS= read -r -d '' directory
    do
        project_name="$(basename "$directory")"
        group_name="$(basename "$(dirname "$directory")")"
        if [[ -f $directory/.git ]]
        then
            :
        else
            echo "${directory},${group_name}-${project_name}"
        fi
    done < <(find "${HOME}/src/gitlab01.bqtstuff.com" -maxdepth 2 -type d -print0)
}

cat > "${HOME}/.config/gita/repo_path" <<EOF
$(config)
EOF

exec -a "$0" gita "$@"
